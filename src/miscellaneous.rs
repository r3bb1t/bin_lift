use zydis::RegisterClass;

/// This file holds some stuff which i don't want to keep in other files. Like extension of
/// zydis::Register enum

/// Just an extended copy of zydis::Register with CPU Flags treated as separate registers
#[derive(Clone, Copy, Debug, Eq, PartialEq, Hash)]
#[repr(C)]
#[allow(clippy::all, dead_code)]
pub enum ExtendedRegisterEnum {
    NONE = 0,
    AL = 1,
    CL = 2,
    DL = 3,
    BL = 4,
    AH = 5,
    CH = 6,
    DH = 7,
    BH = 8,
    SPL = 9,
    BPL = 10,
    SIL = 11,
    DIL = 12,
    R8B = 13,
    R9B = 14,
    R10B = 15,
    R11B = 16,
    R12B = 17,
    R13B = 18,
    R14B = 19,
    R15B = 20,
    AX = 21,
    CX = 22,
    DX = 23,
    BX = 24,
    SP = 25,
    BP = 26,
    SI = 27,
    DI = 28,
    R8W = 29,
    R9W = 30,
    R10W = 31,
    R11W = 32,
    R12W = 33,
    R13W = 34,
    R14W = 35,
    R15W = 36,
    EAX = 37,
    ECX = 38,
    EDX = 39,
    EBX = 40,
    ESP = 41,
    EBP = 42,
    ESI = 43,
    EDI = 44,
    R8D = 45,
    R9D = 46,
    R10D = 47,
    R11D = 48,
    R12D = 49,
    R13D = 50,
    R14D = 51,
    R15D = 52,
    RAX = 53,
    RCX = 54,
    RDX = 55,
    RBX = 56,
    RSP = 57,
    RBP = 58,
    RSI = 59,
    RDI = 60,
    R8 = 61,
    R9 = 62,
    R10 = 63,
    R11 = 64,
    R12 = 65,
    R13 = 66,
    R14 = 67,
    R15 = 68,
    ST0 = 69,
    ST1 = 70,
    ST2 = 71,
    ST3 = 72,
    ST4 = 73,
    ST5 = 74,
    ST6 = 75,
    ST7 = 76,
    X87CONTROL = 77,
    X87STATUS = 78,
    X87TAG = 79,
    MM0 = 80,
    MM1 = 81,
    MM2 = 82,
    MM3 = 83,
    MM4 = 84,
    MM5 = 85,
    MM6 = 86,
    MM7 = 87,
    XMM0 = 88,
    XMM1 = 89,
    XMM2 = 90,
    XMM3 = 91,
    XMM4 = 92,
    XMM5 = 93,
    XMM6 = 94,
    XMM7 = 95,
    XMM8 = 96,
    XMM9 = 97,
    XMM10 = 98,
    XMM11 = 99,
    XMM12 = 100,
    XMM13 = 101,
    XMM14 = 102,
    XMM15 = 103,
    XMM16 = 104,
    XMM17 = 105,
    XMM18 = 106,
    XMM19 = 107,
    XMM20 = 108,
    XMM21 = 109,
    XMM22 = 110,
    XMM23 = 111,
    XMM24 = 112,
    XMM25 = 113,
    XMM26 = 114,
    XMM27 = 115,
    XMM28 = 116,
    XMM29 = 117,
    XMM30 = 118,
    XMM31 = 119,
    YMM0 = 120,
    YMM1 = 121,
    YMM2 = 122,
    YMM3 = 123,
    YMM4 = 124,
    YMM5 = 125,
    YMM6 = 126,
    YMM7 = 127,
    YMM8 = 128,
    YMM9 = 129,
    YMM10 = 130,
    YMM11 = 131,
    YMM12 = 132,
    YMM13 = 133,
    YMM14 = 134,
    YMM15 = 135,
    YMM16 = 136,
    YMM17 = 137,
    YMM18 = 138,
    YMM19 = 139,
    YMM20 = 140,
    YMM21 = 141,
    YMM22 = 142,
    YMM23 = 143,
    YMM24 = 144,
    YMM25 = 145,
    YMM26 = 146,
    YMM27 = 147,
    YMM28 = 148,
    YMM29 = 149,
    YMM30 = 150,
    YMM31 = 151,
    ZMM0 = 152,
    ZMM1 = 153,
    ZMM2 = 154,
    ZMM3 = 155,
    ZMM4 = 156,
    ZMM5 = 157,
    ZMM6 = 158,
    ZMM7 = 159,
    ZMM8 = 160,
    ZMM9 = 161,
    ZMM10 = 162,
    ZMM11 = 163,
    ZMM12 = 164,
    ZMM13 = 165,
    ZMM14 = 166,
    ZMM15 = 167,
    ZMM16 = 168,
    ZMM17 = 169,
    ZMM18 = 170,
    ZMM19 = 171,
    ZMM20 = 172,
    ZMM21 = 173,
    ZMM22 = 174,
    ZMM23 = 175,
    ZMM24 = 176,
    ZMM25 = 177,
    ZMM26 = 178,
    ZMM27 = 179,
    ZMM28 = 180,
    ZMM29 = 181,
    ZMM30 = 182,
    ZMM31 = 183,
    TMM0 = 184,
    TMM1 = 185,
    TMM2 = 186,
    TMM3 = 187,
    TMM4 = 188,
    TMM5 = 189,
    TMM6 = 190,
    TMM7 = 191,
    FLAGS = 192,
    EFLAGS = 193,
    RFLAGS = 194,
    IP = 195,
    EIP = 196,
    RIP = 197,
    ES = 198,
    CS = 199,
    SS = 200,
    DS = 201,
    FS = 202,
    GS = 203,
    GDTR = 204,
    LDTR = 205,
    IDTR = 206,
    TR = 207,
    TR0 = 208,
    TR1 = 209,
    TR2 = 210,
    TR3 = 211,
    TR4 = 212,
    TR5 = 213,
    TR6 = 214,
    TR7 = 215,
    CR0 = 216,
    CR1 = 217,
    CR2 = 218,
    CR3 = 219,
    CR4 = 220,
    CR5 = 221,
    CR6 = 222,
    CR7 = 223,
    CR8 = 224,
    CR9 = 225,
    CR10 = 226,
    CR11 = 227,
    CR12 = 228,
    CR13 = 229,
    CR14 = 230,
    CR15 = 231,
    DR0 = 232,
    DR1 = 233,
    DR2 = 234,
    DR3 = 235,
    DR4 = 236,
    DR5 = 237,
    DR6 = 238,
    DR7 = 239,
    DR8 = 240,
    DR9 = 241,
    DR10 = 242,
    DR11 = 243,
    DR12 = 244,
    DR13 = 245,
    DR14 = 246,
    DR15 = 247,
    K0 = 248,
    K1 = 249,
    K2 = 250,
    K3 = 251,
    K4 = 252,
    K5 = 253,
    K6 = 254,
    K7 = 255,
    BND0 = 256,
    BND1 = 257,
    BND2 = 258,
    BND3 = 259,
    BNDCFG = 260,
    BNDSTATUS = 261,
    MXCSR = 262,
    PKRU = 263,
    XCR0 = 264,
    UIF = 265,

    // Added by me:
    /// Carry flag
    CF = 266,
    /// Parity flag
    PF = 267,
    /// Adjust flag
    AF = 268,
    /// Zero flag
    ZF = 269,
    /// Sign flag
    SF = 270,
    /// Trap flag
    TF = 271,
    /// Interrupt enable flag
    IF = 272,
    /// Direction flag.
    DF = 273,
    /// Overflow flag
    OF = 274,
    /// I/O privilege level flag
    IOPL = 275,
    /// Nested task flag
    NT = 276,
    /// Resume flag
    RF = 280,
    /// Virtual 8086 mode flag
    VM = 281,
    /// Alignment check.
    AC = 282,
    /// Virtual interrupt flag
    VIF = 283,
    /// Virtual interrupt pending.
    VIP = 284,
    /// Able to use CPUID instruction
    ID = 285,

    // Weird ones
    Reserved1,
    Reserved3,
    Reserved5,
}

impl From<zydis::Register> for ExtendedRegisterEnum {
    fn from(value: zydis::Register) -> Self {
        match value {
            zydis::Register::NONE => Self::NONE,
            zydis::Register::AL => Self::AL,
            zydis::Register::CL => Self::CL,
            zydis::Register::DL => Self::DL,
            zydis::Register::BL => Self::BL,
            zydis::Register::AH => Self::AH,
            zydis::Register::CH => Self::CH,
            zydis::Register::DH => Self::DH,
            zydis::Register::BH => Self::BH,
            zydis::Register::SPL => Self::SPL,
            zydis::Register::BPL => Self::BPL,
            zydis::Register::SIL => Self::SIL,
            zydis::Register::DIL => Self::DIL,
            zydis::Register::R8B => Self::R8B,
            zydis::Register::R9B => Self::R9B,
            zydis::Register::R10B => Self::R10B,
            zydis::Register::R11B => Self::R11B,
            zydis::Register::R12B => Self::R12B,
            zydis::Register::R13B => Self::R13B,
            zydis::Register::R14B => Self::R14B,
            zydis::Register::R15B => Self::R15B,
            zydis::Register::AX => Self::AX,
            zydis::Register::CX => Self::CX,
            zydis::Register::DX => Self::DX,
            zydis::Register::BX => Self::BX,
            zydis::Register::SP => Self::SP,
            zydis::Register::BP => Self::BP,
            zydis::Register::SI => Self::SI,
            zydis::Register::DI => Self::DI,
            zydis::Register::R8W => Self::R8W,
            zydis::Register::R9W => Self::R9W,
            zydis::Register::R10W => Self::R10W,
            zydis::Register::R11W => Self::R11W,
            zydis::Register::R12W => Self::R12W,
            zydis::Register::R13W => Self::R13W,
            zydis::Register::R14W => Self::R14W,
            zydis::Register::R15W => Self::R15W,
            zydis::Register::EAX => Self::EAX,
            zydis::Register::ECX => Self::ECX,
            zydis::Register::EDX => Self::EDX,
            zydis::Register::EBX => Self::EBX,
            zydis::Register::ESP => Self::ESP,
            zydis::Register::EBP => Self::EBP,
            zydis::Register::ESI => Self::ESI,
            zydis::Register::EDI => Self::EDI,
            zydis::Register::R8D => Self::R8D,
            zydis::Register::R9D => Self::R9D,
            zydis::Register::R10D => Self::R10D,
            zydis::Register::R11D => Self::R11D,
            zydis::Register::R12D => Self::R12D,
            zydis::Register::R13D => Self::R13D,
            zydis::Register::R14D => Self::R14D,
            zydis::Register::R15D => Self::R15D,
            zydis::Register::RAX => Self::RAX,
            zydis::Register::RCX => Self::RCX,
            zydis::Register::RDX => Self::RDX,
            zydis::Register::RBX => Self::RBX,
            zydis::Register::RSP => Self::RSP,
            zydis::Register::RBP => Self::RBP,
            zydis::Register::RSI => Self::RSI,
            zydis::Register::RDI => Self::RDI,
            zydis::Register::R8 => Self::R8,
            zydis::Register::R9 => Self::R9,
            zydis::Register::R10 => Self::R10,
            zydis::Register::R11 => Self::R11,
            zydis::Register::R12 => Self::R12,
            zydis::Register::R13 => Self::R13,
            zydis::Register::R14 => Self::R14,
            zydis::Register::R15 => Self::R15,
            zydis::Register::ST0 => Self::ST0,
            zydis::Register::ST1 => Self::ST1,
            zydis::Register::ST2 => Self::ST2,
            zydis::Register::ST3 => Self::ST3,
            zydis::Register::ST4 => Self::ST4,
            zydis::Register::ST5 => Self::ST5,
            zydis::Register::ST6 => Self::ST6,
            zydis::Register::ST7 => Self::ST7,
            zydis::Register::X87CONTROL => Self::X87CONTROL,
            zydis::Register::X87STATUS => Self::X87STATUS,
            zydis::Register::X87TAG => Self::X87TAG,
            zydis::Register::MM0 => Self::MM0,
            zydis::Register::MM1 => Self::MM1,
            zydis::Register::MM2 => Self::MM2,
            zydis::Register::MM3 => Self::MM3,
            zydis::Register::MM4 => Self::MM4,
            zydis::Register::MM5 => Self::MM5,
            zydis::Register::MM6 => Self::MM6,
            zydis::Register::MM7 => Self::MM7,
            zydis::Register::XMM0 => Self::XMM0,
            zydis::Register::XMM1 => Self::XMM1,
            zydis::Register::XMM2 => Self::XMM2,
            zydis::Register::XMM3 => Self::XMM3,
            zydis::Register::XMM4 => Self::XMM4,
            zydis::Register::XMM5 => Self::XMM5,
            zydis::Register::XMM6 => Self::XMM6,
            zydis::Register::XMM7 => Self::XMM7,
            zydis::Register::XMM8 => Self::XMM8,
            zydis::Register::XMM9 => Self::XMM9,
            zydis::Register::XMM10 => Self::XMM10,
            zydis::Register::XMM11 => Self::XMM11,
            zydis::Register::XMM12 => Self::XMM12,
            zydis::Register::XMM13 => Self::XMM13,
            zydis::Register::XMM14 => Self::XMM14,
            zydis::Register::XMM15 => Self::XMM15,
            zydis::Register::XMM16 => Self::XMM16,
            zydis::Register::XMM17 => Self::XMM17,
            zydis::Register::XMM18 => Self::XMM18,
            zydis::Register::XMM19 => Self::XMM19,
            zydis::Register::XMM20 => Self::XMM20,
            zydis::Register::XMM21 => Self::XMM21,
            zydis::Register::XMM22 => Self::XMM22,
            zydis::Register::XMM23 => Self::XMM23,
            zydis::Register::XMM24 => Self::XMM24,
            zydis::Register::XMM25 => Self::XMM25,
            zydis::Register::XMM26 => Self::XMM26,
            zydis::Register::XMM27 => Self::XMM27,
            zydis::Register::XMM28 => Self::XMM28,
            zydis::Register::XMM29 => Self::XMM29,
            zydis::Register::XMM30 => Self::XMM30,
            zydis::Register::XMM31 => Self::XMM31,
            zydis::Register::YMM0 => Self::YMM0,
            zydis::Register::YMM1 => Self::YMM1,
            zydis::Register::YMM2 => Self::YMM2,
            zydis::Register::YMM3 => Self::YMM3,
            zydis::Register::YMM4 => Self::YMM4,
            zydis::Register::YMM5 => Self::YMM5,
            zydis::Register::YMM6 => Self::YMM6,
            zydis::Register::YMM7 => Self::YMM7,
            zydis::Register::YMM8 => Self::YMM8,
            zydis::Register::YMM9 => Self::YMM9,
            zydis::Register::YMM10 => Self::YMM10,
            zydis::Register::YMM11 => Self::YMM11,
            zydis::Register::YMM12 => Self::YMM12,
            zydis::Register::YMM13 => Self::YMM13,
            zydis::Register::YMM14 => Self::YMM14,
            zydis::Register::YMM15 => Self::YMM15,
            zydis::Register::YMM16 => Self::YMM16,
            zydis::Register::YMM17 => Self::YMM17,
            zydis::Register::YMM18 => Self::YMM18,
            zydis::Register::YMM19 => Self::YMM19,
            zydis::Register::YMM20 => Self::YMM20,
            zydis::Register::YMM21 => Self::YMM21,
            zydis::Register::YMM22 => Self::YMM22,
            zydis::Register::YMM23 => Self::YMM23,
            zydis::Register::YMM24 => Self::YMM24,
            zydis::Register::YMM25 => Self::YMM25,
            zydis::Register::YMM26 => Self::YMM26,
            zydis::Register::YMM27 => Self::YMM27,
            zydis::Register::YMM28 => Self::YMM28,
            zydis::Register::YMM29 => Self::YMM29,
            zydis::Register::YMM30 => Self::YMM30,
            zydis::Register::YMM31 => Self::YMM31,
            zydis::Register::ZMM0 => Self::ZMM0,
            zydis::Register::ZMM1 => Self::ZMM1,
            zydis::Register::ZMM2 => Self::ZMM2,
            zydis::Register::ZMM3 => Self::ZMM3,
            zydis::Register::ZMM4 => Self::ZMM4,
            zydis::Register::ZMM5 => Self::ZMM5,
            zydis::Register::ZMM6 => Self::ZMM6,
            zydis::Register::ZMM7 => Self::ZMM7,
            zydis::Register::ZMM8 => Self::ZMM8,
            zydis::Register::ZMM9 => Self::ZMM9,
            zydis::Register::ZMM10 => Self::ZMM10,
            zydis::Register::ZMM11 => Self::ZMM11,
            zydis::Register::ZMM12 => Self::ZMM12,
            zydis::Register::ZMM13 => Self::ZMM13,
            zydis::Register::ZMM14 => Self::ZMM14,
            zydis::Register::ZMM15 => Self::ZMM15,
            zydis::Register::ZMM16 => Self::ZMM16,
            zydis::Register::ZMM17 => Self::ZMM17,
            zydis::Register::ZMM18 => Self::ZMM18,
            zydis::Register::ZMM19 => Self::ZMM19,
            zydis::Register::ZMM20 => Self::ZMM20,
            zydis::Register::ZMM21 => Self::ZMM21,
            zydis::Register::ZMM22 => Self::ZMM22,
            zydis::Register::ZMM23 => Self::ZMM23,
            zydis::Register::ZMM24 => Self::ZMM24,
            zydis::Register::ZMM25 => Self::ZMM25,
            zydis::Register::ZMM26 => Self::ZMM26,
            zydis::Register::ZMM27 => Self::ZMM27,
            zydis::Register::ZMM28 => Self::ZMM28,
            zydis::Register::ZMM29 => Self::ZMM29,
            zydis::Register::ZMM30 => Self::ZMM30,
            zydis::Register::ZMM31 => Self::ZMM31,
            zydis::Register::TMM0 => Self::TMM0,
            zydis::Register::TMM1 => Self::TMM1,
            zydis::Register::TMM2 => Self::TMM2,
            zydis::Register::TMM3 => Self::TMM3,
            zydis::Register::TMM4 => Self::TMM4,
            zydis::Register::TMM5 => Self::TMM5,
            zydis::Register::TMM6 => Self::TMM6,
            zydis::Register::TMM7 => Self::TMM7,
            zydis::Register::FLAGS => Self::FLAGS,
            zydis::Register::EFLAGS => Self::EFLAGS,
            zydis::Register::RFLAGS => Self::RFLAGS,
            zydis::Register::IP => Self::IP,
            zydis::Register::EIP => Self::EIP,
            zydis::Register::RIP => Self::RIP,
            zydis::Register::ES => Self::ES,
            zydis::Register::CS => Self::CS,
            zydis::Register::SS => Self::SS,
            zydis::Register::DS => Self::DS,
            zydis::Register::FS => Self::FS,
            zydis::Register::GS => Self::GS,
            zydis::Register::GDTR => Self::GDTR,
            zydis::Register::LDTR => Self::LDTR,
            zydis::Register::IDTR => Self::IDTR,
            zydis::Register::TR => Self::TR,
            zydis::Register::TR0 => Self::TR0,
            zydis::Register::TR1 => Self::TR1,
            zydis::Register::TR2 => Self::TR2,
            zydis::Register::TR3 => Self::TR3,
            zydis::Register::TR4 => Self::TR4,
            zydis::Register::TR5 => Self::TR5,
            zydis::Register::TR6 => Self::TR6,
            zydis::Register::TR7 => Self::TR7,
            zydis::Register::CR0 => Self::CR0,
            zydis::Register::CR1 => Self::CR1,
            zydis::Register::CR2 => Self::CR2,
            zydis::Register::CR3 => Self::CR3,
            zydis::Register::CR4 => Self::CR4,
            zydis::Register::CR5 => Self::CR5,
            zydis::Register::CR6 => Self::CR6,
            zydis::Register::CR7 => Self::CR7,
            zydis::Register::CR8 => Self::CR8,
            zydis::Register::CR9 => Self::CR9,
            zydis::Register::CR10 => Self::CR10,
            zydis::Register::CR11 => Self::CR11,
            zydis::Register::CR12 => Self::CR12,
            zydis::Register::CR13 => Self::CR13,
            zydis::Register::CR14 => Self::CR14,
            zydis::Register::CR15 => Self::CR15,
            zydis::Register::DR0 => Self::DR0,
            zydis::Register::DR1 => Self::DR1,
            zydis::Register::DR2 => Self::DR2,
            zydis::Register::DR3 => Self::DR3,
            zydis::Register::DR4 => Self::DR4,
            zydis::Register::DR5 => Self::DR5,
            zydis::Register::DR6 => Self::DR6,
            zydis::Register::DR7 => Self::DR7,
            zydis::Register::DR8 => Self::DR8,
            zydis::Register::DR9 => Self::DR9,
            zydis::Register::DR10 => Self::DR10,
            zydis::Register::DR11 => Self::DR11,
            zydis::Register::DR12 => Self::DR12,
            zydis::Register::DR13 => Self::DR13,
            zydis::Register::DR14 => Self::DR14,
            zydis::Register::DR15 => Self::DR15,
            zydis::Register::K0 => Self::K0,
            zydis::Register::K1 => Self::K1,
            zydis::Register::K2 => Self::K2,
            zydis::Register::K3 => Self::K3,
            zydis::Register::K4 => Self::K4,
            zydis::Register::K5 => Self::K5,
            zydis::Register::K6 => Self::K6,
            zydis::Register::K7 => Self::K7,
            zydis::Register::BND0 => Self::BND0,
            zydis::Register::BND1 => Self::BND1,
            zydis::Register::BND2 => Self::BND2,
            zydis::Register::BND3 => Self::BND3,
            zydis::Register::BNDCFG => Self::BNDCFG,
            zydis::Register::BNDSTATUS => Self::BNDSTATUS,
            zydis::Register::MXCSR => Self::MXCSR,
            zydis::Register::PKRU => Self::PKRU,
            zydis::Register::XCR0 => Self::XCR0,
            zydis::Register::UIF => Self::UIF,
        }
    }
}

impl From<ExtendedRegisterEnum> for zydis::Register {
    fn from(value: ExtendedRegisterEnum) -> Self {
        match value {
            ExtendedRegisterEnum::NONE => Self::NONE,
            ExtendedRegisterEnum::AL => Self::AL,
            ExtendedRegisterEnum::CL => Self::CL,
            ExtendedRegisterEnum::DL => Self::DL,
            ExtendedRegisterEnum::BL => Self::BL,
            ExtendedRegisterEnum::AH => Self::AH,
            ExtendedRegisterEnum::CH => Self::CH,
            ExtendedRegisterEnum::DH => Self::DH,
            ExtendedRegisterEnum::BH => Self::BH,
            ExtendedRegisterEnum::SPL => Self::SPL,
            ExtendedRegisterEnum::BPL => Self::BPL,
            ExtendedRegisterEnum::SIL => Self::SIL,
            ExtendedRegisterEnum::DIL => Self::DIL,
            ExtendedRegisterEnum::R8B => Self::R8B,
            ExtendedRegisterEnum::R9B => Self::R9B,
            ExtendedRegisterEnum::R10B => Self::R10B,
            ExtendedRegisterEnum::R11B => Self::R11B,
            ExtendedRegisterEnum::R12B => Self::R12B,
            ExtendedRegisterEnum::R13B => Self::R13B,
            ExtendedRegisterEnum::R14B => Self::R14B,
            ExtendedRegisterEnum::R15B => Self::R15B,
            ExtendedRegisterEnum::AX => Self::AX,
            ExtendedRegisterEnum::CX => Self::CX,
            ExtendedRegisterEnum::DX => Self::DX,
            ExtendedRegisterEnum::BX => Self::BX,
            ExtendedRegisterEnum::SP => Self::SP,
            ExtendedRegisterEnum::BP => Self::BP,
            ExtendedRegisterEnum::SI => Self::SI,
            ExtendedRegisterEnum::DI => Self::DI,
            ExtendedRegisterEnum::R8W => Self::R8W,
            ExtendedRegisterEnum::R9W => Self::R9W,
            ExtendedRegisterEnum::R10W => Self::R10W,
            ExtendedRegisterEnum::R11W => Self::R11W,
            ExtendedRegisterEnum::R12W => Self::R12W,
            ExtendedRegisterEnum::R13W => Self::R13W,
            ExtendedRegisterEnum::R14W => Self::R14W,
            ExtendedRegisterEnum::R15W => Self::R15W,
            ExtendedRegisterEnum::EAX => Self::EAX,
            ExtendedRegisterEnum::ECX => Self::ECX,
            ExtendedRegisterEnum::EDX => Self::EDX,
            ExtendedRegisterEnum::EBX => Self::EBX,
            ExtendedRegisterEnum::ESP => Self::ESP,
            ExtendedRegisterEnum::EBP => Self::EBP,
            ExtendedRegisterEnum::ESI => Self::ESI,
            ExtendedRegisterEnum::EDI => Self::EDI,
            ExtendedRegisterEnum::R8D => Self::R8D,
            ExtendedRegisterEnum::R9D => Self::R9D,
            ExtendedRegisterEnum::R10D => Self::R10D,
            ExtendedRegisterEnum::R11D => Self::R11D,
            ExtendedRegisterEnum::R12D => Self::R12D,
            ExtendedRegisterEnum::R13D => Self::R13D,
            ExtendedRegisterEnum::R14D => Self::R14D,
            ExtendedRegisterEnum::R15D => Self::R15D,
            ExtendedRegisterEnum::RAX => Self::RAX,
            ExtendedRegisterEnum::RCX => Self::RCX,
            ExtendedRegisterEnum::RDX => Self::RDX,
            ExtendedRegisterEnum::RBX => Self::RBX,
            ExtendedRegisterEnum::RSP => Self::RSP,
            ExtendedRegisterEnum::RBP => Self::RBP,
            ExtendedRegisterEnum::RSI => Self::RSI,
            ExtendedRegisterEnum::RDI => Self::RDI,
            ExtendedRegisterEnum::R8 => Self::R8,
            ExtendedRegisterEnum::R9 => Self::R9,
            ExtendedRegisterEnum::R10 => Self::R10,
            ExtendedRegisterEnum::R11 => Self::R11,
            ExtendedRegisterEnum::R12 => Self::R12,
            ExtendedRegisterEnum::R13 => Self::R13,
            ExtendedRegisterEnum::R14 => Self::R14,
            ExtendedRegisterEnum::R15 => Self::R15,
            ExtendedRegisterEnum::ST0 => Self::ST0,
            ExtendedRegisterEnum::ST1 => Self::ST1,
            ExtendedRegisterEnum::ST2 => Self::ST2,
            ExtendedRegisterEnum::ST3 => Self::ST3,
            ExtendedRegisterEnum::ST4 => Self::ST4,
            ExtendedRegisterEnum::ST5 => Self::ST5,
            ExtendedRegisterEnum::ST6 => Self::ST6,
            ExtendedRegisterEnum::ST7 => Self::ST7,
            ExtendedRegisterEnum::X87CONTROL => Self::X87CONTROL,
            ExtendedRegisterEnum::X87STATUS => Self::X87STATUS,
            ExtendedRegisterEnum::X87TAG => Self::X87TAG,
            ExtendedRegisterEnum::MM0 => Self::MM0,
            ExtendedRegisterEnum::MM1 => Self::MM1,
            ExtendedRegisterEnum::MM2 => Self::MM2,
            ExtendedRegisterEnum::MM3 => Self::MM3,
            ExtendedRegisterEnum::MM4 => Self::MM4,
            ExtendedRegisterEnum::MM5 => Self::MM5,
            ExtendedRegisterEnum::MM6 => Self::MM6,
            ExtendedRegisterEnum::MM7 => Self::MM7,
            ExtendedRegisterEnum::XMM0 => Self::XMM0,
            ExtendedRegisterEnum::XMM1 => Self::XMM1,
            ExtendedRegisterEnum::XMM2 => Self::XMM2,
            ExtendedRegisterEnum::XMM3 => Self::XMM3,
            ExtendedRegisterEnum::XMM4 => Self::XMM4,
            ExtendedRegisterEnum::XMM5 => Self::XMM5,
            ExtendedRegisterEnum::XMM6 => Self::XMM6,
            ExtendedRegisterEnum::XMM7 => Self::XMM7,
            ExtendedRegisterEnum::XMM8 => Self::XMM8,
            ExtendedRegisterEnum::XMM9 => Self::XMM9,
            ExtendedRegisterEnum::XMM10 => Self::XMM10,
            ExtendedRegisterEnum::XMM11 => Self::XMM11,
            ExtendedRegisterEnum::XMM12 => Self::XMM12,
            ExtendedRegisterEnum::XMM13 => Self::XMM13,
            ExtendedRegisterEnum::XMM14 => Self::XMM14,
            ExtendedRegisterEnum::XMM15 => Self::XMM15,
            ExtendedRegisterEnum::XMM16 => Self::XMM16,
            ExtendedRegisterEnum::XMM17 => Self::XMM17,
            ExtendedRegisterEnum::XMM18 => Self::XMM18,
            ExtendedRegisterEnum::XMM19 => Self::XMM19,
            ExtendedRegisterEnum::XMM20 => Self::XMM20,
            ExtendedRegisterEnum::XMM21 => Self::XMM21,
            ExtendedRegisterEnum::XMM22 => Self::XMM22,
            ExtendedRegisterEnum::XMM23 => Self::XMM23,
            ExtendedRegisterEnum::XMM24 => Self::XMM24,
            ExtendedRegisterEnum::XMM25 => Self::XMM25,
            ExtendedRegisterEnum::XMM26 => Self::XMM26,
            ExtendedRegisterEnum::XMM27 => Self::XMM27,
            ExtendedRegisterEnum::XMM28 => Self::XMM28,
            ExtendedRegisterEnum::XMM29 => Self::XMM29,
            ExtendedRegisterEnum::XMM30 => Self::XMM30,
            ExtendedRegisterEnum::XMM31 => Self::XMM31,
            ExtendedRegisterEnum::YMM0 => Self::YMM0,
            ExtendedRegisterEnum::YMM1 => Self::YMM1,
            ExtendedRegisterEnum::YMM2 => Self::YMM2,
            ExtendedRegisterEnum::YMM3 => Self::YMM3,
            ExtendedRegisterEnum::YMM4 => Self::YMM4,
            ExtendedRegisterEnum::YMM5 => Self::YMM5,
            ExtendedRegisterEnum::YMM6 => Self::YMM6,
            ExtendedRegisterEnum::YMM7 => Self::YMM7,
            ExtendedRegisterEnum::YMM8 => Self::YMM8,
            ExtendedRegisterEnum::YMM9 => Self::YMM9,
            ExtendedRegisterEnum::YMM10 => Self::YMM10,
            ExtendedRegisterEnum::YMM11 => Self::YMM11,
            ExtendedRegisterEnum::YMM12 => Self::YMM12,
            ExtendedRegisterEnum::YMM13 => Self::YMM13,
            ExtendedRegisterEnum::YMM14 => Self::YMM14,
            ExtendedRegisterEnum::YMM15 => Self::YMM15,
            ExtendedRegisterEnum::YMM16 => Self::YMM16,
            ExtendedRegisterEnum::YMM17 => Self::YMM17,
            ExtendedRegisterEnum::YMM18 => Self::YMM18,
            ExtendedRegisterEnum::YMM19 => Self::YMM19,
            ExtendedRegisterEnum::YMM20 => Self::YMM20,
            ExtendedRegisterEnum::YMM21 => Self::YMM21,
            ExtendedRegisterEnum::YMM22 => Self::YMM22,
            ExtendedRegisterEnum::YMM23 => Self::YMM23,
            ExtendedRegisterEnum::YMM24 => Self::YMM24,
            ExtendedRegisterEnum::YMM25 => Self::YMM25,
            ExtendedRegisterEnum::YMM26 => Self::YMM26,
            ExtendedRegisterEnum::YMM27 => Self::YMM27,
            ExtendedRegisterEnum::YMM28 => Self::YMM28,
            ExtendedRegisterEnum::YMM29 => Self::YMM29,
            ExtendedRegisterEnum::YMM30 => Self::YMM30,
            ExtendedRegisterEnum::YMM31 => Self::YMM31,
            ExtendedRegisterEnum::ZMM0 => Self::ZMM0,
            ExtendedRegisterEnum::ZMM1 => Self::ZMM1,
            ExtendedRegisterEnum::ZMM2 => Self::ZMM2,
            ExtendedRegisterEnum::ZMM3 => Self::ZMM3,
            ExtendedRegisterEnum::ZMM4 => Self::ZMM4,
            ExtendedRegisterEnum::ZMM5 => Self::ZMM5,
            ExtendedRegisterEnum::ZMM6 => Self::ZMM6,
            ExtendedRegisterEnum::ZMM7 => Self::ZMM7,
            ExtendedRegisterEnum::ZMM8 => Self::ZMM8,
            ExtendedRegisterEnum::ZMM9 => Self::ZMM9,
            ExtendedRegisterEnum::ZMM10 => Self::ZMM10,
            ExtendedRegisterEnum::ZMM11 => Self::ZMM11,
            ExtendedRegisterEnum::ZMM12 => Self::ZMM12,
            ExtendedRegisterEnum::ZMM13 => Self::ZMM13,
            ExtendedRegisterEnum::ZMM14 => Self::ZMM14,
            ExtendedRegisterEnum::ZMM15 => Self::ZMM15,
            ExtendedRegisterEnum::ZMM16 => Self::ZMM16,
            ExtendedRegisterEnum::ZMM17 => Self::ZMM17,
            ExtendedRegisterEnum::ZMM18 => Self::ZMM18,
            ExtendedRegisterEnum::ZMM19 => Self::ZMM19,
            ExtendedRegisterEnum::ZMM20 => Self::ZMM20,
            ExtendedRegisterEnum::ZMM21 => Self::ZMM21,
            ExtendedRegisterEnum::ZMM22 => Self::ZMM22,
            ExtendedRegisterEnum::ZMM23 => Self::ZMM23,
            ExtendedRegisterEnum::ZMM24 => Self::ZMM24,
            ExtendedRegisterEnum::ZMM25 => Self::ZMM25,
            ExtendedRegisterEnum::ZMM26 => Self::ZMM26,
            ExtendedRegisterEnum::ZMM27 => Self::ZMM27,
            ExtendedRegisterEnum::ZMM28 => Self::ZMM28,
            ExtendedRegisterEnum::ZMM29 => Self::ZMM29,
            ExtendedRegisterEnum::ZMM30 => Self::ZMM30,
            ExtendedRegisterEnum::ZMM31 => Self::ZMM31,
            ExtendedRegisterEnum::TMM0 => Self::TMM0,
            ExtendedRegisterEnum::TMM1 => Self::TMM1,
            ExtendedRegisterEnum::TMM2 => Self::TMM2,
            ExtendedRegisterEnum::TMM3 => Self::TMM3,
            ExtendedRegisterEnum::TMM4 => Self::TMM4,
            ExtendedRegisterEnum::TMM5 => Self::TMM5,
            ExtendedRegisterEnum::TMM6 => Self::TMM6,
            ExtendedRegisterEnum::TMM7 => Self::TMM7,
            ExtendedRegisterEnum::FLAGS => Self::FLAGS,
            ExtendedRegisterEnum::EFLAGS => Self::EFLAGS,
            ExtendedRegisterEnum::RFLAGS => Self::RFLAGS,
            ExtendedRegisterEnum::IP => Self::IP,
            ExtendedRegisterEnum::EIP => Self::EIP,
            ExtendedRegisterEnum::RIP => Self::RIP,
            ExtendedRegisterEnum::ES => Self::ES,
            ExtendedRegisterEnum::CS => Self::CS,
            ExtendedRegisterEnum::SS => Self::SS,
            ExtendedRegisterEnum::DS => Self::DS,
            ExtendedRegisterEnum::FS => Self::FS,
            ExtendedRegisterEnum::GS => Self::GS,
            ExtendedRegisterEnum::GDTR => Self::GDTR,
            ExtendedRegisterEnum::LDTR => Self::LDTR,
            ExtendedRegisterEnum::IDTR => Self::IDTR,
            ExtendedRegisterEnum::TR => Self::TR,
            ExtendedRegisterEnum::TR0 => Self::TR0,
            ExtendedRegisterEnum::TR1 => Self::TR1,
            ExtendedRegisterEnum::TR2 => Self::TR2,
            ExtendedRegisterEnum::TR3 => Self::TR3,
            ExtendedRegisterEnum::TR4 => Self::TR4,
            ExtendedRegisterEnum::TR5 => Self::TR5,
            ExtendedRegisterEnum::TR6 => Self::TR6,
            ExtendedRegisterEnum::TR7 => Self::TR7,
            ExtendedRegisterEnum::CR0 => Self::CR0,
            ExtendedRegisterEnum::CR1 => Self::CR1,
            ExtendedRegisterEnum::CR2 => Self::CR2,
            ExtendedRegisterEnum::CR3 => Self::CR3,
            ExtendedRegisterEnum::CR4 => Self::CR4,
            ExtendedRegisterEnum::CR5 => Self::CR5,
            ExtendedRegisterEnum::CR6 => Self::CR6,
            ExtendedRegisterEnum::CR7 => Self::CR7,
            ExtendedRegisterEnum::CR8 => Self::CR8,
            ExtendedRegisterEnum::CR9 => Self::CR9,
            ExtendedRegisterEnum::CR10 => Self::CR10,
            ExtendedRegisterEnum::CR11 => Self::CR11,
            ExtendedRegisterEnum::CR12 => Self::CR12,
            ExtendedRegisterEnum::CR13 => Self::CR13,
            ExtendedRegisterEnum::CR14 => Self::CR14,
            ExtendedRegisterEnum::CR15 => Self::CR15,
            ExtendedRegisterEnum::DR0 => Self::DR0,
            ExtendedRegisterEnum::DR1 => Self::DR1,
            ExtendedRegisterEnum::DR2 => Self::DR2,
            ExtendedRegisterEnum::DR3 => Self::DR3,
            ExtendedRegisterEnum::DR4 => Self::DR4,
            ExtendedRegisterEnum::DR5 => Self::DR5,
            ExtendedRegisterEnum::DR6 => Self::DR6,
            ExtendedRegisterEnum::DR7 => Self::DR7,
            ExtendedRegisterEnum::DR8 => Self::DR8,
            ExtendedRegisterEnum::DR9 => Self::DR9,
            ExtendedRegisterEnum::DR10 => Self::DR10,
            ExtendedRegisterEnum::DR11 => Self::DR11,
            ExtendedRegisterEnum::DR12 => Self::DR12,
            ExtendedRegisterEnum::DR13 => Self::DR13,
            ExtendedRegisterEnum::DR14 => Self::DR14,
            ExtendedRegisterEnum::DR15 => Self::DR15,
            ExtendedRegisterEnum::K0 => Self::K0,
            ExtendedRegisterEnum::K1 => Self::K1,
            ExtendedRegisterEnum::K2 => Self::K2,
            ExtendedRegisterEnum::K3 => Self::K3,
            ExtendedRegisterEnum::K4 => Self::K4,
            ExtendedRegisterEnum::K5 => Self::K5,
            ExtendedRegisterEnum::K6 => Self::K6,
            ExtendedRegisterEnum::K7 => Self::K7,
            ExtendedRegisterEnum::BND0 => Self::BND0,
            ExtendedRegisterEnum::BND1 => Self::BND1,
            ExtendedRegisterEnum::BND2 => Self::BND2,
            ExtendedRegisterEnum::BND3 => Self::BND3,
            ExtendedRegisterEnum::BNDCFG => Self::BNDCFG,
            ExtendedRegisterEnum::BNDSTATUS => Self::BNDSTATUS,
            ExtendedRegisterEnum::MXCSR => Self::MXCSR,
            ExtendedRegisterEnum::PKRU => Self::PKRU,
            ExtendedRegisterEnum::XCR0 => Self::XCR0,
            ExtendedRegisterEnum::UIF => Self::UIF,
            _ => unreachable!("Tried to convert {value:?} to zydis reg"),
        }
    }
}

pub(crate) fn is_reg_floating_point(reg: zydis::Register) -> bool {
    match reg.class() {
        RegisterClass::X87 | zydis::RegisterClass::MMX => true,
        RegisterClass::INVALID
        | RegisterClass::GPR8
        | RegisterClass::GPR16
        | RegisterClass::GPR32
        | RegisterClass::GPR64
        | RegisterClass::XMM
        | RegisterClass::YMM
        | RegisterClass::ZMM
        | RegisterClass::TMM
        | RegisterClass::FLAGS
        | RegisterClass::IP
        | RegisterClass::SEGMENT
        | RegisterClass::TABLE
        | RegisterClass::TEST
        | RegisterClass::CONTROL
        | RegisterClass::DEBUG
        | RegisterClass::MASK
        | RegisterClass::BOUND => false,
    }
}
